<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
    <style>
        /*dinh dang cac button các button là các quân cờ*/
        button{
            height: 90px;
            width: 90px;
            font-size: 35px;
            font-weight: bold;
            border: none;
        }
        
        /*định dạng bàn cờ DIV*/
        .board{
            display: flex;
            flex-wrap: wrap;
            height: 270px;
            width: 270px;
        }
        .choi{
            background-color: blue;
        }
        .dongho{
            
            height: 40px;
            width: 270px;
            text-align: center;
        }
    </style>

<body>
    <!--thiet lap dong ho cho game-->
    <div class="dongho" >
          
        <h2 id="dongho"></h2>
      </div>
    <!--Thiet ke giao dien la 1 bang 3x3 cac button--> 
    <div class="board">
        <!--bang 0-->
        <button onclick="move(0,0)" id="b00">1</button>
        <button  onclick="move(0,1)" id="b01">2</button>
        <button onclick="move(0,2)" id="b02">3</button>
        <!--bang 1-->
        <button onclick="move(1,0)" id="b10">4</button>
        <button onclick="move(1,1)" id="b11">5</button>
        <button onclick="move(1,2)" id="b12">6</button>
        <!--bang 2-->
        <button onclick="move(2,0)" id="b20">7</button>
        <button onclick="move(2,1)"id="b21">8</button>
        <button onclick="move(2,2)" id="b22">9</button>
    </div>
    <br>
    <!--click vao thi doi mau cac nut-->
    <button onclick="doiMau()">Color</button>
    <button>
        <a href = "puzzel4x4.html">To 4x4</a> 
    </button>
    <script>
        //PHAN 1: KHAI BAO BIEN=========================================================================
        //khai báo biến
        // khai báo dữ liệu cho quân cờ
        const data =[
            ["1","2","3"],
            ["4","5","6"],
            ["7","8"," "],
        ]
        // tạo mảng 2 chiều 3x3 để quản lý các BUTTON
        const b = [
            [document.getElementById('b00'),document.getElementById('b01'),document.getElementById('b02')],
            [document.getElementById('b10'),document.getElementById('b11'),document.getElementById('b12')],
            [document.getElementById('b20'),document.getElementById('b21'),document.getElementById('b22')],
        ]
        const bangMau = ["green", "lightgreen", "blue", "lightblue", "pink", "lightpink", "#E7B10A", "#898121"];
        let mau = 0;
        // PHAN 2: cac ham==========================
        setInterval(chinhdongho, 1000);
            let gio=0;
            let phut=0;
            let giay=0;
          function chinhdongho(){
                if(giay<60){
                giay++;
                }else{
                giay=0;
                if(phut<5){
                phut++;
                }else{
                phut=0;
                if(gio<5){
                  gio++;
                }else{
                  gio=0;
                }
              }
            }
            txt=gio+":"+phut+":"+giay;
            document.getElementById("dongho").innerHTML=txt;
          }
        //-------------------------------------
        function doiMau() {
            if (mau < bangMau.length - 2) mau++;
            else mau = 0;
            veMauNen();
        }
        // ve mau cho cac quan co-----------------------------------
        function veMauNen() {
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if ((i + j) % 2 == 0) b[i][j].style.background = bangMau[mau];
                    else b[i][j].style.background = bangMau[mau + 1]; 
                }
            }
        }
        //cho so ngau nhien tu 1 2 3 ...n-1
        function randInt(n){
            return Math.floor(Math.random() * n);
        }
        //--------------------------------------------------------------------
        //di chuyen o trong ngau nhien
        function randMove(){
            let u = 2, v = 2;//vi tri o trong
            let soLan = 0;
            do{
                switch(randInt(4)){
                    case 0://doi o trong sang trai
                    if (namTrong(u,v-1)){
                    data[u][v] = data[u][v-1];
                    data[u][v-1] = " ";
                    v = v - 1; //o trong moi
                    }
                    break;
                    case 1://doi o trong sang phai
                    if (namTrong(u,v+1)){
                    data[u][v] = data[u][v+1];
                    data[u][v+1] = " ";
                    v = v + 1;
                    }
                    break;
                    case 2://doi o trong len tren
                    if (namTrong(u - 1,v)){
                    data[u][v] = data[u - 1][v];
                    data[u - 1][v] = " ";
                    u = u - 1;
                    }
                    break;
                    case 3://doi o trong len tren
                    if (namTrong(u + 1,v)){
                    data[u][v] = data[u + 1][v];
                    data[u + 1][v] = " ";
                    u = u + 1;
                    }
                    break;
                }
                soLan++;
            }while(soLan < 5);
            //data[2][2] = data[1][2];
            //data[1][2] = " "; //xoa

            //data[1][2] = data[1][1];
            //data[1][1] = " ";
            veChuSo();

        }
        //------------------------------------------------------------------------------------------------------
        function checkin(){
            let dem = 0;
            for(let i = 0; i < 3; i++){
                for(let j = 0; j < 3; j++){
                    //i*3+j+1 se la 1 2 3 4 5 6 7 8 9
                    if(i * 3 + j + 1 == data[i][j]) 
                    dem++;
                }
            }
            if (dem == 8) return true;
            return false;
        }
        //---------------------------------------------------------------------------------------------
        //xen ô x, y nằm trong hay nằm ngoài bàn cờ
        // true = namTrong; false = !namTrong
        function namTrong(x,y){
            if(x >=0 && x <3 && y<3) return true;
            else return false;

        }
        //-----------------------------------------------------------------------------------------------------------
        //khai báo hàm dùng ngoạc tròn
        function move(i,j){
            //doi o so [i][j] sang ben phải [i][j+1]
            if( namTrong(i,j+1) && data[i][j+1] ==" "){
                data[i][j+1] = data[i][j];
                data[i][j]=" ";
            }
            //dời ô số [i][j] sang trái [i][i-1] 
            else  if( namTrong(i,j-1) && data[i][j-1] ==" "){
                data[i][j-1] = data[i][j];
                data[i][j]=" ";
            }
            //dời ô số [i][j] xuống dưới [i + 1]=[j]
             else  if( namTrong(i +1,j) && data[i+1][j] ==" "){
                data[i +1][j] = data[i][j];
                data[i][j]=" ";
            }
            //dời ô số [i][j] xuống dưới [i - 1]=[j]
            else if( namTrong(i - 1,j) && data[i-1][j] ==" "){
                data[i -1][j] = data[i][j];
                data[i][j]=" ";
            }
           // data[2][2]=data[2][1];
            //data[2][1]=" ";
            veChuSo();
            if (checkin()) {
            alert("Ban da thang!")
            //xu li khi thang: hien nut de len man 4
            document.getElementById("upto4").hidden = false;
            }
        }
        function veChuSo(){
            for (let i = 0; i<3; i++){
                for(let j = 0; j < 3; j++){
                    b[i][j].textContent = data[i][j];
                }
        }
    }
        //vẽ màu cho các quân cờ
        function vemaunen(){
            for (let i = 0; i<3; i++){
                for(let j = 0; j < 3; j++){
                    if((i+j) %2 == 0) b[i][j].style.background = "#E5D1FA";//ô chẵn màu xanh
                    else b[i][j].style.background = "#ECF2FF";//ô lẻ màu nhạt
                }
            }
        }
        //phan3 chuong trinh chinh
        vemaunen();     
        veChuSo();
        randMove();
        
    </script>
</body>
</html>

